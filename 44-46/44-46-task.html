<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
	<script src=".\44-46-task.js"></script>
<script type="text/javascript">
var foodmenu = [['Fish',10,1],['Tomato',20,2],['Egg',30,3],['Chicken',40,3],['Hamburger',50,7]];
var Waiter=function(name){
	this.name = name;
}
Waiter.prototype = {
	getcusmenu:function(arr){
		var readymenu=menutostr(arr,',');
		var myname;
		if(Waiter.getInstance().name){
			myname=Waiter.getInstance().name;
		}
		else{
			throw '没有服务员';
		}
        var p=new Promise(function(resolve,reject){
        	console.log('服务员'+myname+'得到订单'+readymenu);
		setTimeout(function(){
			console.log('服务员'+myname+'告知厨师订单:'+readymenu);
			resolve(arr);
		},2000);
        });
		return p;
		
	}
    
    
};
Waiter.getInstance = (function(name) {
	var instance;
	return function(name){
		if (!instance) {
			instance = new Waiter(name);
		}
		return instance;
	}
})();

var Coof = function(name){this.name = name;};
Coof.prototype = {
	cooking:function(arr){
		
		var sortarr=arr.sort(function(obj1,obj2){
			return obj1[2]-obj2[2];
		});
		var p=new Promise(function(resolve,reject){
            for (var i = 0; i < sortarr.length; i++) {
            	setTimeout(function(sortarr[i]){
                    console.log(sortarr[i]+'已做好');
                    
            	})
            }
		});
		
	}
        
	
};
Coof.getInstance = (function(name) {
	var instance;
	return function(name){
		if (!instance) {
			instance = new Coof(name);
		}
		return instance;
	}
})();

function Customer(name){
    this.name = name;
}
Customer.prototype = {
	foodorder:function(menu){
        var name=this.name;
        console.log('顾客'+name+'入座');
        //arr 订单（二维数组[['food','price','time'],[]])
        var arr=this.cusgetfood(menu);
        var foodstr=menutostr(arr,',');

        var p=new Promise(function(resolve,reject){
        	setTimeout(function(){
        		console.log(name+'点了'+foodstr);
        		//console.log(arr);
        		resolve(arr);
        	},3000);
        });
        return p;
	},
	//随机点多个菜方法
	cusgetfood:function(arr){
		var menu=arr.slice();
		var list=[];
		var len=menu.length;
		//n=点几个菜
		var n=parseInt(Math.random()*len+1);
		for (var i = 0; i < n; i++) {
			var index=parseInt(Math.random()*menu.length);
			//二维数组menu调用splice方法返回的也是二维数组
			//例:[['s','a'],['b']].splice(0,1)执行后得到[['s','a']]
			list.push(menu.splice(index,1)[0]);
		}
		//console.log(list);
		return list;
		
	}
};
//将二维菜单转换成字符串
function menutostr(arr,sign){
    var newarr=[];
    var sign=sign+'';
    if(arr instanceof Array){
    	if (arr[0] instanceof Array) {
    	    for (var i = 0; i < arr.length; i++) {
        	newarr.push(arr[i][0]);
          }
        }
        else{
        	throw 'this is not a 二维arr';
        }
    }
        
    return newarr.join(sign);
}
var xiaoli=Waiter.getInstance('xiaoli');
var xiaohong=Coof.getInstance('xiaohong');
var cus=new Customer('xy');
//var cusarr=[];cusarr.length=10;
//for (var i = 0; i < cusarr.length; i++) {
    //cusarr[i]=new Customer(foodlist);
//}
//var cusqueue = new Queue(cusarr,cusarr.length);










	
</script>

</body>
</html>